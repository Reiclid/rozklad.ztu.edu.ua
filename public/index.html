<!DOCTYPE html>
<html lang="uk">

<head>
  <meta charset="UTF-8">
  <title>–†–æ–∑–∫–ª–∞–¥ –≥—Ä—É–ø (–Ü–ü–ó, –í–¢, –ö–ù)</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="style.css">
  <link rel="icon" type="image/png" href="face.png">

  <!-- Open Graph (OG) —Ç–µ–≥–∏ –¥–ª—è —Å–æ—Ü–º–µ—Ä–µ–∂ -->
  <meta property="og:url" content="https://reiclid.github.io/rozklad.ztu.edu.ua/">
  <meta property="og:type" content="website" />
  <meta property="og:image" content="https://i.imgur.com/YbjxjPD.png">
  <meta property="og:image:type" content="image/png">
  <meta property="og:image:width" content="1200">
  <meta property="og:image:height" content="630">
  <meta property="og:site_name" content="–†–æ–∑–∫–ª–∞–¥-–≥—Ä—É–ø">
  <meta property="og:title" content="–†–æ–∑–∫–ª–∞–¥ –≥—Ä—É–ø (–Ü–ü–ó, –í–¢, –ö–ù)">
  <meta property="og:description" content="–û–±–µ—Ä—ñ—Ç—å —Å–≤–æ—é –≥—Ä—É–ø—É —Ç–∞ –ø–µ—Ä–µ–≥–ª—è–Ω—å—Ç–µ –∞–∫—Ç—É–∞–ª—å–Ω–∏–π —Ä–æ–∑–∫–ª–∞–¥ –∑–∞–Ω—è—Ç—å!">
</head>

<body>
  <script src="visual.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/lodash.js/4.17.21/lodash.min.js"></script>

  <div class="container">
    <div class="clearDivalert">
      <div class="cleartext">
        <p>–ß–∏ —Ç–æ—á–Ω–æ –≤–∏ —Ö–æ—á–µ—Ç–µ —Å–∫–∏–Ω—É—Ç–∏ –≤—Å—ñ —Ö–µ—à–æ–≤–∞–Ω—ñ –¥–∞–Ω–Ω—ñ —Å–∞–π—Ç—É?</p>
      </div>
      <div  class="clearbtns">
        <button class="clearBtnYES" onclick="clearLocalStorage()">–¢–∞–∫</button>
        <button class="clearBtnNO" onclick="toggleClear()">–ù—ñ</button>
      </div>
    </div>
    <button class="CleanBtn" onclick="toggleClear()">üîÑ</button>
    <button class="OpenLoginBtn" onclick="toggleLogin()">üîë</button>
    <form class="LoginForm fade-in">
      <h2 style="color: white; margin-bottom: 15px;">–í—Ö—ñ–¥ —á–µ—Ä–µ–∑ Cabinet.ztu</h2>
      <p class="alarm">–¶–µ–π —Å–∞–π—Ç –Ω–µ –º—ñ—Å—Ç–∏—Ç—å –∂–æ–¥–Ω–æ–≥–æ –∑–∞—Ö–∏—Å—Ç—É —Ç–∞ –Ω–µ –∑–∞–±–µ–∑–ø–µ—á—É—î –±–µ–∑–ø–µ–∫—É –ø–µ—Ä–µ–¥–∞–Ω–∏—Ö –¥–∞–Ω–∏—Ö.
        –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ –π–æ–≥–æ –Ω–∞ —Å–≤—ñ–π —Å—Ç—Ä–∞—Ö —ñ —Ä–∏–∑–∏–∫. –Ø –Ω–µ –Ω–µ—Å—É –≤—ñ–¥–ø–æ–≤—ñ–¥–∞–ª—å–Ω–æ—Å—Ç—ñ –∑–∞ –±—É–¥—å-—è–∫—ñ –º–æ–∂–ª–∏–≤—ñ –Ω–∞—Å–ª—ñ–¥–∫–∏.</p>
      <input type="text" name="username" placeholder="–õ–æ–≥—ñ–Ω">
      <input type="password" name="password" placeholder="–ü–∞—Ä–æ–ª—å">
      <input type="button" value="–£–≤—ñ–π—Ç–∏" onclick="submitLogin()">
    </form>
    <h1>–†–æ–∑–∫–ª–∞–¥ –≥—Ä—É–ø</h1>
    <header>

    </header>
    <main>
      <div id="scheduleContainer">
        <p>–≤–∏–±–µ—Ä—ñ—Ç—å –≥—Ä—É–ø—É</p>
        <!-- –†–æ–∑–∫–ª–∞–¥ –≤—ñ–¥–æ–±—Ä–∞–∑–∏—Ç—å—Å—è —É –≤–∏–≥–ª—è–¥—ñ –∫–∞—Ä—Ç–æ–∫ -->
      </div>
    </main>
    <nav>
      <div id="groupContainer">
        <div id="groupScroll">
          <!-- –ì—Ä—É–ø–∏ –±—É–¥—É—Ç—å –¥–æ–¥–∞–≤–∞—Ç–∏—Å—è —á–µ—Ä–µ–∑ JavaScript -->
        </div>
      </div>

      <ul id="dayMenu">
        <li data-full="–ü–æ–Ω–µ–¥—ñ–ª–æ–∫" data-short="–ü–Ω"></li>
        <li data-full="–í—ñ–≤—Ç–æ—Ä–æ–∫" data-short="–í—Ç"></li>
        <li data-full="–°–µ—Ä–µ–¥–∞" data-short="–°—Ä"></li>
        <li data-full="–ß–µ—Ç–≤–µ—Ä" data-short="–ß—Ç"></li>
        <li data-full="–ü'—è—Ç–Ω–∏—Ü—è" data-short="–ü—Ç"></li>
        <li data-full="–°—É–±–æ—Ç–∞" data-short="–°–±"></li>
        <li data-full="–ù–µ–¥—ñ–ª—è" data-short="–ù–¥"></li>
        <li data-full="–í—Å–µ" data-short="–í—Å–µ"></li>
        <li data-full="–õ" data-short="–õ"></li>
      </ul>
    </nav>
    <footer>
      <p>by reiclid</p>
    </footer>

  </div>

  <script>
    function clearLocalStorage() {
      location.reload();
      localStorage.clear();
      console.log("üóëÔ∏è LocalStorage –æ—á–∏—â–µ–Ω–æ!");
    }

    // showLoaderSite()

    function showLoaderSite() {
      let loaderDiv = document.querySelector(".loaderDiv");
      console.log('–ü–æ–∫–∞–∑—É—î–º –ó–∞–≥—Ä—É–∑–∫—É!');
      if (!loaderDiv) {
        loaderDiv = document.createElement("div");
        loaderDiv.classList.add("loaderDiv");
        loaderDiv.innerHTML = `
        <div class="loadersite"></div>
        <div class="loadersitetext"><h1>–ó–∞—á–µ–∫–∞–π—Ç–µ –±—É–¥—å–ª–∞—Å–∫–∞</h1></div>
        
        `;
        document.body.appendChild(loaderDiv); // –î–æ–¥–∞—î–º–æ —É body, –∞ –Ω–µ –≤ `scheduleContainer`
      }

      loaderDiv.style.opacity = "1";
      loaderDiv.style.visibility = "visible";
      loaderDiv.style.zIndex = "9999"; // –ü—ñ–¥–Ω—ñ–º–∞—î–º–æ –Ω–∞–≤–µ—Ä—Ö
    }

    function hideLoaderSite() {
      let loaderDiv = document.querySelector(".loaderDiv");
      console.log('–ü—Ä—è—á–µ–º –ó–∞–≥—Ä—É–∑–∫—É!');

      if (loaderDiv) {
        loaderDiv.style.opacity = "0";
        setTimeout(() => {
          loaderDiv.style.visibility = "hidden";
          loaderDiv.style.zIndex = "-1"; // –û–ø—É—Å–∫–∞—î–º–æ –≤–Ω–∏–∑
        }, 300); // –ß–µ–∫–∞—î–º–æ –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—è –∞–Ω—ñ–º–∞—Ü—ñ—ó
      } else {
        console.warn("‚ùå –õ–æ–∞–¥–µ—Ä –≤–∂–µ –≤–∏–¥–∞–ª–µ–Ω–∏–π –∞–±–æ –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ!");
      }
    }

    async function getProxyUrl() {
      try {
        const response = await fetch('proxy.txt');
        const text = await response.text();
        const urls = text
          .split(/\r?\n/)
          .map(url => url.trim().replace(/^["']|["']$/g, '')) // –í–∏–¥–∞–ª—è—î–º–æ –ª–∞–ø–∫–∏ –∑ –ø–æ—á–∞—Ç–∫—É —ñ –∫—ñ–Ω—Ü—è
          .filter(url => url.length > 0); // –§—ñ–ª—å—Ç—Ä—É—î–º–æ –ø–æ—Ä–æ–∂–Ω—ñ —Ä—è–¥–∫–∏

        for (const url of urls) {
          if (!url) continue; // –Ü–≥–Ω–æ—Ä—É—î–º–æ –ø—É—Å—Ç—ñ —Ä—è–¥–∫–∏
          console.log(`üîç –ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ URL: ${url}`);
          try {
            // –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ —Ä–µ–∂–∏–º "no-cors", —â–æ–± —É–Ω–∏–∫–Ω—É—Ç–∏ –±–ª–æ–∫—É–≤–∞–Ω–Ω—è –±—Ä–∞—É–∑–µ—Ä–æ–º
            const checkResponse = await fetch(url + '/iscorsneeded', { method: 'GET', mode: 'no-cors' });

            // –Ø–∫—â–æ fetch –Ω–µ –≤–∏–∫–∏–Ω—É–≤ –ø–æ–º–∏–ª–∫—É, –≤–≤–∞–∂–∞—î–º–æ –ø—Ä–æ–∫—Å—ñ —Ä–æ–±–æ—á–∏–º
            console.log(`‚úÖ –†–æ–±–æ—á–∏–π URL –∑–Ω–∞–π–¥–µ–Ω–æ: ${url}`);
            return url.endsWith('/') ? url : url + '/'; // –ü–µ—Ä–µ–∫–æ–Ω—É—î–º–æ—Å—è, —â–æ —î `/` –≤ –∫—ñ–Ω—Ü—ñ
          } catch (err) {
            console.warn(`‚ùå URL –Ω–µ –ø—Ä–∞—Ü—é—î: ${url}`, err);
          }
        }

        throw new Error("‚ùå –ù–µ–º–∞—î —Ä–æ–±–æ—á–∏—Ö –ø—Ä–æ–∫—Å—ñ!");
      } catch (err) {
        console.error("‚ùå –ü–æ–º–∏–ª–∫–∞ –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –ø—Ä–æ–∫—Å—ñ URL:", err);
        return null;
      }
    }

    let proxyUrl = '';
    let baseUrl = '';
    let groupListUrl = '';

    getProxyUrl().then(url => {
      if (url) {
        proxyUrl = url;
        console.log("üü¢ –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è Proxy URL –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–æ:", proxyUrl);
        baseUrl = 'https://rozklad.ztu.edu.ua';
        console.log("üü¢ baseList URL –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–æ:", baseUrl);
        groupListUrl = proxyUrl + 'proxy?url=https://rozklad.ztu.edu.ua/schedule/group/list';
        console.log("üü¢ groupList URL –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–æ:", groupListUrl);
        // –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ proxyUrl –≤ —ñ–Ω—à–∏—Ö —á–∞—Å—Ç–∏–Ω–∞—Ö –∫–æ–¥—É
        loadGroups().then(() => {
          const selectedGroupUrl = localStorage.getItem("selectedGroup");
          if (selectedGroupUrl) {
            console.log(`üîÑ –ó–∞–≤–∞–Ω—Ç–∞–∂—É—î–º–æ —Ä–æ–∑–∫–ª–∞–¥ –¥–ª—è –∑–±–µ—Ä–µ–∂–µ–Ω–æ—ó –≥—Ä—É–ø–∏: ${selectedGroupUrl}`);
            loadSchedule(selectedGroupUrl);
          } else {
            console.warn("‚ö† –ù–µ–º–∞—î –≤–∏–±—Ä–∞–Ω–æ—ó –≥—Ä—É–ø–∏. –ë—É–¥—å –ª–∞—Å–∫–∞, –≤–∏–±–µ—Ä—ñ—Ç—å –≥—Ä—É–ø—É.");
          }
        });
        populateDayMenu();
        updateDayNames();
      } else {
        console.error("üö® –ù–µ–º–∞—î —Ä–æ–±–æ—á–æ–≥–æ –ø—Ä–æ–∫—Å—ñ!");
      }
    });
    let loginGroup = ''
    const groupSelect = document.getElementById('groupSelect');
    const dayMenu = document.getElementById('dayMenu');
    const scheduleContainer = document.getElementById('scheduleContainer');
    let days = ['–ü–æ–Ω–µ–¥—ñ–ª–æ–∫', '–í—ñ–≤—Ç–æ—Ä–æ–∫', '–°–µ—Ä–µ–¥–∞', '–ß–µ—Ç–≤–µ—Ä', "–ü'—è—Ç–Ω–∏—Ü—è", '–°—É–±–æ—Ç–∞', '–ù–µ–¥—ñ–ª—è', '–í—Å–µ', '–õ'];
    let daysshortNames = ["–ü–Ω", "–í—Ç", "–°—Ä", "–ß—Ç", "–ü—Ç", "–°–±", "–ù–¥", "–í—Å–µ", "–õ"];
    const groupScroll = document.getElementById('groupScroll');
    let groupslist = [];
    let iddays = ''

    // –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –≤–∏–±—Ä–∞–Ω–æ–≥–æ –¥–Ω—è –∑ localStorage
    let selectedDayIndex = parseInt(localStorage.getItem('selectedDayIndex')) || 0;

    function updateDayNames() {
      const isMobile = window.innerWidth < 768;
      document.querySelectorAll("#dayMenu li").forEach((li, index) => {
        const fullNames = days;
        const shortNames = daysshortNames;

        li.textContent = isMobile ? shortNames[index] : fullNames[index];
      });
    }

    window.addEventListener("DOMContentLoaded", updateDayNames);
    window.addEventListener("resize", updateDayNames);

    async function autoLogin() {
      const token = localStorage.getItem("authToken");
      if (!token) {
        console.log("üîí –¢–æ–∫–µ–Ω –≤—ñ–¥—Å—É—Ç–Ω—ñ–π, –ø–æ—Ç—Ä—ñ–±–µ–Ω —Ä—É—á–Ω–∏–π –≤—Ö—ñ–¥");
        return;
      }

      console.log("üîÑ –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∏–π –≤—Ö—ñ–¥...");
      try {
        const response = await fetch("http://127.0.0.1:8080/api/auto-login", {
          method: "POST",
          headers: { "Authorization": `Bearer ${token}`, "Content-Type": "application/json" }
        });

        const data = await response.json();
        if (data.success) {
          console.log("‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∏–π –≤—Ö—ñ–¥ —É—Å–ø—ñ—à–Ω–∏–π!");
          document.querySelector(".LoginForm").style.display = "none";
          const savedCookies = JSON.parse(localStorage.getItem("authCookies"));
          if (savedCookies) {
            window.userCookies = savedCookies;
          }
          parseSchedule(data.schedule);
          const selectedGroupUrl = localStorage.getItem("selectedGroup");
          //loadSchedulelogin();
        } else {
          console.log("‚ùå –¢–æ–∫–µ–Ω –Ω–µ–¥—ñ–π—Å–Ω–∏–π, –≤–∏–¥–∞–ª—è—î–º–æ...");
          localStorage.removeItem("authToken");
        }
      } catch (error) {
        console.error("‚ùå –ü–æ–º–∏–ª–∫–∞ –∞–≤—Ç–æ-–≤—Ö–æ–¥—É:", error);
        localStorage.removeItem("authToken");
      }
    }

    document.addEventListener("DOMContentLoaded", autoLogin);

    function submitLogin() {
      showLoaderSite();
      const username = document.querySelector("input[name='username']").value;
      const password = document.querySelector("input[name='password']").value;

      if (!username || !password) {
        alert("‚ùå –í–≤–µ–¥—ñ—Ç—å –ª–æ–≥—ñ–Ω —ñ –ø–∞—Ä–æ–ª—å!");
        return;
      }

      console.log("üì° –í—ñ–¥–ø—Ä–∞–≤–ª—è—î–º–æ –∑–∞–ø–∏—Ç...");
      fetch("http://127.0.0.1:8080/api/login", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ username, password })
      })
        .then(response => response.json())
        .then(data => {
          if (data.success) {
            // alert("‚úÖ –í—Ö—ñ–¥ —É—Å–ø—ñ—à–Ω–∏–π!");
            hideLoaderSite();
            document.querySelector(".LoginForm").style.display = "none";

            // –ó–±–µ—Ä—ñ–≥–∞—î–º–æ —Ç–æ–∫–µ–Ω —É `localStorage`
            localStorage.setItem("authToken", data.token);
            localStorage.setItem("authCookies", JSON.stringify(data.cookies));

            // –ü–∞—Ä—Å–∏–º–æ HTML-—Ä–æ–∑–∫–ª–∞–¥
            parseSchedule(data.schedule);
          } else {
            alert("‚ùå –ü–æ–º–∏–ª–∫–∞ –≤—Ö–æ–¥—É!");
          }
        })
        .catch(error => console.error("‚ùå –ü–æ–º–∏–ª–∫–∞:", error));
    }

    function parseSchedule(html) {
      const parser = new DOMParser();
      const doc = parser.parseFromString(html, "text/html");

      // –û—Ç—Ä–∏–º—É—î–º–æ –Ω–∞–∑–≤—É –≥—Ä—É–ø–∏
      const groupName = doc.querySelector("h2")?.textContent.replace("–ì—Ä—É–ø–∞ ", "").trim() || "–ù–µ–≤—ñ–¥–æ–º–∞ –≥—Ä—É–ø–∞";
      console.log("üìå –ù–∞–∑–≤–∞ –≥—Ä—É–ø–∏:", groupName);

      // –í—ñ–¥–æ–±—Ä–∞–∂–∞—î–º–æ —Ä–æ–∑–∫–ª–∞–¥ –Ω–∞ —Å—Ç–æ—Ä—ñ–Ω—Ü—ñ
      loginGroup = groupName;

      updateUI();
    }

    function updateUI() {
      // –î–æ–¥–∞—î–º–æ –≥—Ä—É–ø—É –≤ —Å–ø–∏—Å–æ–∫, —è–∫—â–æ —ó—ó —Ç–∞–º –Ω–µ–º–∞—î
      days[8] = loginGroup;
      daysshortNames[8] = loginGroup;
      // –û–Ω–æ–≤–ª—é—î–º–æ –º–µ–Ω—é –≤–∏–±–æ—Ä—É –¥–Ω—è

      updateDayNames();

      console.log("üìå –û–Ω–æ–≤–ª–µ–Ω–æ UI, loginGroup:", loginGroup);
      iddays = localStorage.getItem("iddays")
      console.log(`–°–µ–π—á–∞—Å –≤–∏–±—Ä–∞–Ω –î–ï–ù–¨ ${iddays}`);
      if (iddays == 8) {
        loadSchedulelogin();
      }
    }

    function saveScheduleToLocalStorage() {
      localStorage.setItem("scheduleData", scheduleContainer.innerHTML);
    }

    function loadScheduleFromLocalStorage() {
      let savedSchedule = localStorage.getItem("scheduleData");
      if (savedSchedule) {
        scheduleContainer.innerHTML = savedSchedule;
        updateCardEffects();
      } else {
        console.log("‚ùå –î–∞–Ω—ñ –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ –≤ localStorage, –∑–∞–≤–∞–Ω—Ç–∞–∂—É—î–º–æ —Ä–æ–∑–∫–ª–∞–¥ —á–µ—Ä–µ–∑ API...");
        loadSchedulelogin(); // –í–∏–∫–ª–∏–∫–∞—î–º–æ API, —è–∫—â–æ –≤ LocalStorage –Ω–µ–º–∞—î —Ä–æ–∑–∫–ª–∞–¥—É
      }
    }

    function parseScheduleFromHTML(html, day) {
      if (day == 1) {
        showLoaderSite();
      }
      if (day == 8) {

      }

      const parser = new DOMParser();
      const doc = parser.parseFromString(html, "text/html");

      let curday = days[day - 1];
      let curtime = '';
      let curobj = '';
      let curlec = '';
      let curlecaud = '';
      let vic = '';
      let data = '';

      let CurDaydiv = document.createElement("h3");
      CurDaydiv.innerHTML = `${curday}`;
      scheduleContainer.appendChild(CurDaydiv);

      let pairs = doc.querySelectorAll('.pair');
      let pairscontent = [...pairs].map(pair => pair.querySelectorAll('div')); // –ë–µ—Ä–µ–º–æ 2-–π div —É –∫–æ–∂–Ω–æ–º—É .pair

      console.log(pairscontent);
      if (pairscontent.length === 0) {
        console.log('–ü–æ–º–∏–ª–∫–∞ –Ω–µ–º–∞—î —Ä–æ–∑–∫–ª–∞–¥—É!!!');

        let errorroz = document.createElement("div");
        errorroz.classList.add("error-message");

        errorroz.innerHTML = `–ù–µ–º–∞—î –ø–∞—Ä –Ω–∞ —Ü–µ–π –¥–µ–Ω—å`;
        scheduleContainer.appendChild(errorroz);
        return
      }

      if (day = 1) {
        let siogodniday = doc.querySelector('.container h1');
        scheduleContainer.appendChild(siogodniday);
      }

      pairscontent.forEach(elements => {
        // const indate = element.querySelectorAll('.time');
        elements.forEach((element, index) => {
          // if (!element.classList.contains('date') && index !== 7 && index !== 8) {
          //   data.push(element.innerHTML);
          // }
          if (index === 1) { curtime = element.innerHTML }
          if (index === 2) { curobj = element.innerHTML }
          if (index === 3) { curlec = element.innerHTML }
          if (index === 4) { curlecaud = element.innerHTML }
          if (index === 5) { vic = element.innerHTML }
          if (index === 6) { data = element.innerHTML }
        });

        let scheduleCard = document.createElement("div");
        scheduleCard.classList.add("schedule-card");

        scheduleCard.innerHTML = `
          <h3>${curday} ‚Äì –ü–∞—Ä–∞ (${curtime})</h3>
          <div class="pairs">
            <div class="pair  vertical" style="order: ">
              <div class="subject">
                ${curobj}
              </div>
              <div class="activity-tag">
                ${curlec}
              </div>
              <div class="room">
                –∞—É–¥.${curlecaud}
              </div>
              <div class="teacher">
                ${vic}
              </div>
              <div class="subject" style="font-size: 10px;">
                ${data}
              </div>
            </div>
          </div>
        `;

        scheduleContainer.appendChild(scheduleCard);
        console.log(data);
        data = []
      });

    }

    async function fetchScheduleFromCabinet(week, day) {
      const token = localStorage.getItem("authToken");
      if (!token) {
        console.error("‚ùå –ù–µ–º–∞—î –∑–±–µ—Ä–µ–∂–µ–Ω–æ–≥–æ —Ç–æ–∫–µ–Ω–∞. –°–ø–æ—á–∞—Ç–∫—É —É–≤—ñ–π–¥—ñ—Ç—å —É —Å–∏—Å—Ç–µ–º—É.");
        return null;
      }

      console.log(`üìå –í—ñ–¥–ø—Ä–∞–≤–ª—è—î–º–æ –∑–∞–ø–∏—Ç –Ω–∞ —Å–µ—Ä–≤–µ—Ä –¥–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è —Ä–æ–∑–∫–ª–∞–¥—É (–¢–∏–∂–¥–µ–Ω—å ${week}, –î–µ–Ω—å ${day})`);

      try {
        const response = await fetch("http://127.0.0.1:8080/api/schedule", {
          method: "POST",
          headers: {
            "Content-Type": "application/json",
            "Authorization": `Bearer ${token}`
          },
          body: JSON.stringify({ week, day })
        });

        const data = await response.json();
        if (!data.success) throw new Error(data.error);

        console.log("‚úÖ –û—Ç—Ä–∏–º–∞–Ω–æ —Ä–æ–∑–∫–ª–∞–¥ –∑ —Å–µ—Ä–≤–µ—Ä–∞");
        // console.log(data.schedule);
        return data.schedule;

      } catch (error) {
        console.error("‚ùå –ü–æ–º–∏–ª–∫–∞ –æ—Ç—Ä–∏–º–∞–Ω–Ω—è —Ä–æ–∑–∫–ª–∞–¥—É:", error);
        return null;
      }
    }

    async function compareSchedules(groupId) {

      const currentWeek = await getCurrentWeekFromRozklad(groupId);
      if (currentWeek === null) {
        console.error("‚ùå –ù–µ –≤–¥–∞–ª–æ—Å—è –æ—Ç—Ä–∏–º–∞—Ç–∏ –Ω–æ–º–µ—Ä —Ç–∏–∂–Ω—è.");
        return;
      }

      console.log(`üìå –ü–æ—Ç–æ—á–Ω–∏–π —Ç–∏–∂–¥–µ–Ω—å: ${currentWeek}`);
      scheduleContainer.innerHTML = "";
      for (i = 1; i < 8; i++) {
        // –û—Ç—Ä–∏–º—É—î–º–æ —Ä–æ–∑–∫–ª–∞–¥–∏, –≤–∫–∞–∑—É—é—á–∏ –ø–æ–Ω–µ–¥—ñ–ª–æ–∫ —è–∫ —Å—Ç–∞—Ä—Ç–æ–≤–∏–π –¥–µ–Ω—å
        const cabinetScheduleHtml = await fetchScheduleFromCabinet(currentWeek, i);
        if (!cabinetScheduleHtml) {
          console.error("‚ùå –ù–µ –≤–¥–∞–ª–æ—Å—è –æ—Ç—Ä–∏–º–∞—Ç–∏ —Ä–æ–∑–∫–ª–∞–¥ –∑ –∫–∞–±—ñ–Ω–µ—Ç—É.");
          return;
        }
        const cabinetSchedule = parseScheduleFromHTML(cabinetScheduleHtml, i);
        const groupSchedule = await fetchGroupSchedule(groupId);
      }

      const currentDay = selectedDayIndex;
      saveScheduleToLocalStorage();
      hideLoaderSite();
      console.log("üìå –°—å–æ–≥–æ–¥–Ω—ñ: ", currentDay);
      // console.log("üìå –†–æ–∑–∫–ª–∞–¥ –≥—Ä—É–ø–∏: ", groupSchedule[currentDay]);

      // –û–±'—î–¥–Ω—É—î–º–æ –¥–∞–Ω—ñ

      // console.log("‚úÖ –û–±'—î–¥–Ω–∞–Ω–∏–π —Ä–æ–∑–∫–ª–∞–¥:", mergedSchedule);
    }

    async function fetchGroupSchedule(groupId) {
      try {
        console.log(`üîÑ –û—Ç—Ä–∏–º—É—î–º–æ —Ä–æ–∑–∫–ª–∞–¥ –¥–ª—è –≥—Ä—É–ø–∏ (ID: ${groupId})`);

        const response = await fetch(`${proxyUrl}proxy?url=https://rozklad.ztu.edu.ua/schedule/group?id=${groupId}`);
        const text = await response.text();

        const parser = new DOMParser();
        const doc = parser.parseFromString(text, "text/html");

        const schedule = {};

        // –û—Ç—Ä–∏–º—É—î–º–æ –≤—Å—ñ —Ä—è–¥–∫–∏ —Ç–∞–±–ª–∏—Ü—ñ —Ä–æ–∑–∫–ª–∞–¥—É
        const rows = doc.querySelectorAll(".schedule tbody tr");

        rows.forEach(row => {
          const timeCell = row.querySelector("th.hour-name");
          if (!timeCell) return; // –Ø–∫—â–æ —Ü–µ –Ω–µ —Ä—è–¥–æ–∫ –∑ –ø–∞—Ä–æ—é, –ø—Ä–æ–ø—É—Å–∫–∞—î–º–æ

          const periodNumber = timeCell.querySelector(".name")?.textContent.trim() || "";
          const timeRange = timeCell.querySelector(".full-name")?.textContent.trim() || "";

          const dayCells = row.querySelectorAll("td");

          dayCells.forEach((cell, index) => {
            const details = cell.textContent.trim();
            if (!details) return; // –ü—Ä–æ–ø—É—Å–∫–∞—î–º–æ –ø–æ—Ä–æ–∂–Ω—ñ –∫–æ–º—ñ—Ä–∫–∏

            if (!schedule[index]) schedule[index] = [];
            schedule[index].push({
              period: periodNumber,
              time: timeRange,
              subject: details
            });
          });
        });

        console.log("‚úÖ –û—Ç—Ä–∏–º–∞–Ω–æ —Ä–æ–∑–∫–ª–∞–¥ –≥—Ä—É–ø–∏:", schedule);
        return schedule;

      } catch (error) {
        console.error("‚ùå –ü–æ–º–∏–ª–∫–∞ –æ—Ç—Ä–∏–º–∞–Ω–Ω—è —Ä–æ–∑–∫–ª–∞–¥—É –≥—Ä—É–ø–∏:", error);
        return null;
      }
    }

    async function getCurrentWeekFromRozklad(groupId) {
      const response = await fetch(`${proxyUrl}proxy?url=${encodeURIComponent(`https://rozklad.ztu.edu.ua/schedule/group?id=${groupId}`)}`);
      const text = await response.text();

      const parser = new DOMParser();
      const doc = parser.parseFromString(text, "text/html");

      // –û—Ç—Ä–∏–º—É—î–º–æ –ø–æ—Ç–æ—á–Ω–∏–π —Ç–∏–∂–¥–µ–Ω—å (–∑–∞–∑–≤–∏—á–∞–π <h2>–¢–∏–∂–¥–µ–Ω—å 0</h2>)
      const weekHeader = doc.querySelector(".wrapper h2")?.textContent.trim();
      const weekMatch = weekHeader.match(/\d+/); // –í–∏–¥—ñ–ª—è—î–º–æ —á–∏—Å–ª–æ
      return weekMatch ? parseInt(weekMatch[0], 10) : null;
    }

    // –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –Ω–∞ –ø–µ—Ä–µ–∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Å—Ç–æ—Ä—ñ–Ω–∫–∏
    const isReload = (() => {
      try {
        return performance.getEntriesByType("navigation")[0].type === "reload";
      } catch {
        return performance.navigation?.type === performance.navigation.TYPE_RELOAD;
      }
    })();

    function showLoader() {
      return '<div class="loader">–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è...</div>';
    }

    function showError(message) {
      return `<div class="error-message">${message}</div>`;
    }

    function populateDayMenu() {
      console.log("üìå –ó–∞–ø–æ–≤–Ω—é—î–º–æ –º–µ–Ω—é –¥–Ω—ñ–≤");
      dayMenu.innerHTML = days
        .map((day, index) => `
          <li data-index="${index}" 
              class="${index === selectedDayIndex ? 'active' : ''}"
              onclick="selectDay(${index})">
            ${day}
          </li>
        `).join('');
    }

    function selectDay(index) {
      console.log(`üìå –í–∏–±—Ä–∞–Ω–æ –¥–µ–Ω—å: ${days[index]}`);
      selectedDayIndex = index;
      localStorage.setItem('selectedDayIndex', index);
      updateDayMenu();
      iddays = index;
      localStorage.setItem("iddays", iddays);
      console.log(`–°–µ–π—á–∞—Å –≤–∏–±—Ä–∞–Ω –î–ï–ù–¨ ${iddays}`);

      localStorage.removeItem(`cachedSchedule_${localStorage.getItem("selectedGroup")}_${selectedDayIndex}`);
      // –û—Ç—Ä–∏–º—É—î–º–æ –∑–±–µ—Ä–µ–∂–µ–Ω—É –≥—Ä—É–ø—É
      selectedGroupUrl = localStorage.getItem("selectedGroup");

      if (selectedGroupUrl) {
        console.log(`üîÑ –ó–∞–≤–∞–Ω—Ç–∞–∂—É—î–º–æ —Ä–æ–∑–∫–ª–∞–¥ –¥–ª—è –≤–∏–±—Ä–∞–Ω–æ—ó –≥—Ä—É–ø–∏: ${selectedGroupUrl}`);
        if (index === 8) {
          loadSchedulelogin();
          return
        }
        loadSchedule(selectedGroupUrl);
      } else if (index != 8) {
        scheduleContainer.innerHTML = `
        <p>–≤–∏–±–µ—Ä—ñ—Ç—å –≥—Ä—É–ø—É</p>
        `;
        console.warn("‚ùå –ù–µ–º–∞—î –≤–∏–±—Ä–∞–Ω–æ—ó –≥—Ä—É–ø–∏ –¥–ª—è –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ä–æ–∑–∫–ª–∞–¥—É!");
      } else if (index === 8) {
        if (!loginGroup) {
          toggleLogin();
          return
        }
        loadSchedulelogin();
      }
    }

    async function loadSchedulelogin() {
      if (localStorage.getItem("scheduleData")) {
        loadScheduleFromLocalStorage();
        return
      }

      const foundGroup = groupslist.find(group => group.name === loginGroup);

      if (foundGroup) {
        // –û—Ç—Ä–∏–º—É—î–º–æ `id` –∑ `href`, –ø—Ä–∏–ø—É—Å–∫–∞—é—á–∏, —â–æ `id=209` –∑–Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è –≤ –∫—ñ–Ω—Ü—ñ –ø–æ—Å–∏–ª–∞–Ω–Ω—è
        const groupIdMatch = foundGroup.href.match(/id=(\d+)/);
        const groupId = groupIdMatch ? groupIdMatch[1] : null;

        if (groupId) {
          console.log(`‚úÖ –ó–Ω–∞–π–¥–µ–Ω–∞ –≥—Ä—É–ø–∞: ${foundGroup.name} (ID: ${groupId})`);

          compareSchedules(groupId);
        } else {
          console.error(`‚ùå –ù–µ –≤–¥–∞–ª–æ—Å—è –æ—Ç—Ä–∏–º–∞—Ç–∏ ID –¥–ª—è –≥—Ä—É–ø–∏ ${foundGroup.name}`);
        }
      } else {
        console.error(`‚ùå –ì—Ä—É–ø—É ${loginGroup} –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ —É —Å–ø–∏—Å–∫—É!`);
      }
    }

    function updateDayMenu() {
      console.log("üìå –û–Ω–æ–≤–ª–µ–Ω–Ω—è —Å—Ç–∏–ª—ñ–≤ –¥–ª—è –≤–∏–±—Ä–∞–Ω–æ–≥–æ –¥–Ω—è");
      dayMenu.querySelectorAll('li').forEach(item => {
        item.classList.toggle('active', parseInt(item.dataset.index) === selectedDayIndex);
      });
    }

    function populateGroupScroll(groups) {
      console.log("üìå –ó–∞–ø–æ–≤–Ω—é—î–º–æ —Å–ø–∏—Å–æ–∫ –≥—Ä—É–ø", groups);
      const groupScroll = document.getElementById('groupScroll');
      if (!groupScroll) {
        console.error("‚ùå –ü–æ–º–∏–ª–∫–∞: –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è –≥—Ä—É–ø –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ!");
        return;
      }

      groupScroll.innerHTML = groups.map(group => `
          <div class="group-item" data-href="${group.href}">${group.name}</div>
      `).join('');

      // –í—ñ–¥–Ω–æ–≤–ª–µ–Ω–Ω—è –≤–∏–±—Ä–∞–Ω–æ—ó –≥—Ä—É–ø–∏
      const storedGroup = localStorage.getItem('selectedGroup');
      if (storedGroup) {
        document.querySelectorAll('.group-item').forEach(item => {
          if (item.dataset.href === storedGroup) {
            item.classList.add('active');
          }
        });
      }

      // –î–æ–¥–∞—î–º–æ –ø–æ–¥—ñ—ó –∫–ª—ñ–∫—É –¥–ª—è –≤–∏–±–æ—Ä—É –≥—Ä—É–ø–∏
      document.querySelectorAll('.group-item').forEach(item => {
        item.addEventListener('click', () => {
          document.querySelectorAll('.group-item').forEach(i => i.classList.remove('active'));
          item.classList.add('active');
          localStorage.setItem('selectedGroup', item.dataset.href);
          loadSchedule(item.dataset.href);
        });
      });
    }

    async function fetchURLs(Url) {
      const response = await fetch(Url, {
        mode: "cors",
        headers: {
          "ngrok-skip-browser-warning": "true",
          "X-Requested-With": "XMLHttpRequest"
        }
      });

      if (!response.ok) throw new Error(`‚ùå –°–µ—Ä–≤–µ—Ä –ø–æ–≤–µ—Ä–Ω—É–≤ –ø–æ–º–∏–ª–∫—É: ${response.status}`);

      const html = await response.text();
      const parser = new DOMParser();
      const doc = parser.parseFromString(html, 'text/html');

      return doc;
    }

    async function loadGroups() {
      if (!proxyUrl) {
        console.log("‚è≥ –û—á—ñ–∫—É—î–º–æ proxyUrl –ø–µ—Ä–µ–¥ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è–º –≥—Ä—É–ø...");
        setTimeout(loadGroups, 500); // –ü–æ–≤—Ç–æ—Ä —á–µ—Ä–µ–∑ 0.5 —Å–µ–∫—É–Ω–¥–∏
        return;
      }

      try {
        console.log("üîÑ –ó–∞–≤–∞–Ω—Ç–∞–∂—É—î–º–æ –≥—Ä—É–ø–∏ –∑ —Å–µ—Ä–≤–µ—Ä–∞:", groupListUrl);

        const doc = await fetchURLs(groupListUrl);

        const groups = Array.from(doc.querySelectorAll('.courses-list .groups-list a'))
          .filter(anchor => /^(–Ü–ü–ó(?!–∫)|–í–¢(?!–∫)|–ö–ù(?!–∫))/.test(anchor.textContent.trim()))
          .map(anchor => ({
            name: anchor.textContent.trim(),
            href: new URL(anchor.getAttribute('href'), baseUrl).toString()
          }));

        localStorage.setItem('cachedGroups', JSON.stringify(groups));
        populateGroupScroll(groups);
        groupslist = groups;
        console.log(groupslist);

      } catch (err) {
        console.error('–ü–æ–º–∏–ª–∫–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –≥—Ä—É–ø:', err);
        groupSelect.innerHTML = '<option value="">–ü–æ–º–∏–ª–∫–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –≥—Ä—É–ø</option>';
      }
    }


    async function loadSchedule(selectedGroupUrl) {
      if (!selectedGroupUrl) {
        console.warn("‚ùå –ù–µ–º–∞—î –≤–∏–±—Ä–∞–Ω–æ—ó –≥—Ä—É–ø–∏ –¥–ª—è –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ä–æ–∑–∫–ª–∞–¥—É!");
        scheduleContainer.innerHTML = '';
        return;
      }

      const selectedGroupName = document.querySelector(`.group-item[data-href="${selectedGroupUrl}"]`)?.textContent || "–û–±—Ä–∞–Ω–∞ –≥—Ä—É–ø–∞";
      const isAllDays = selectedDayIndex === days.length - 2; // –Ø–∫—â–æ –æ–±—Ä–∞–Ω–æ "–í—Å–µ"
      const isAllDaysLogin = selectedDayIndex === days.length - 1; // –Ø–∫—â–æ –æ–±—Ä–∞–Ω–æ "–í—Å–µ"
      const scheduleCacheKey = `cachedSchedule_${selectedGroupUrl}_${selectedDayIndex}`;

      console.log(`üìå –ó–∞–≤–∞–Ω—Ç–∞–∂—É—î–º–æ —Ä–æ–∑–∫–ª–∞–¥ –¥–ª—è ${selectedGroupName} (${days[selectedDayIndex]})`);

      const cachedSchedule = localStorage.getItem(scheduleCacheKey);
      if (cachedSchedule && !isAllDays) {
        console.log("‚úÖ –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ –∫–µ—à–æ–≤–∞–Ω–∏–π —Ä–æ–∑–∫–ª–∞–¥");
        scheduleContainer.innerHTML = cachedSchedule;
        return;
      }

      scheduleContainer.innerHTML = showLoader();

      try {
        console.log("üîÑ –ó–∞–ø–∏—Ç —Ä–æ–∑–∫–ª–∞–¥—É –∑ —Å–µ—Ä–≤–µ—Ä–∞...", selectedGroupUrl);

        const doc = await fetchURLs(`${proxyUrl}proxy?url=${encodeURIComponent(selectedGroupUrl)}`);

        const table = doc.querySelector('.wrapper table.schedule');
        if (!table) throw new Error('‚ùå –†–æ–∑–∫–ª–∞–¥ –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ');

        let scheduleHTML = `<h2>–†–æ–∑–∫–ª–∞–¥ –¥–ª—è ${selectedGroupName} (${isAllDays ? "–í—Å—ñ –¥–Ω—ñ" : days[selectedDayIndex]})</h2>`;

        if (isAllDays) {
          // –í–∏–≤–æ–¥–∏–º–æ –≤—Å—ñ –¥–Ω—ñ, –∞–ª–µ —Ç—ñ–ª—å–∫–∏ —Ç—ñ –ø–∞—Ä–∏, —è–∫—ñ –º–∞—é—Ç—å –∑–∞–Ω—è—Ç—Ç—è
          days.slice(0, -1).forEach((day, index) => {
            let daySchedule = Array.from(table.querySelectorAll('tbody tr'))
              .map(row => {
                const hourTh = row.querySelector('th.hour-name');
                if (!hourTh) return '';

                const periodNumber = hourTh.querySelector('.name')?.textContent.trim() || '';
                const timeRange = hourTh.querySelector('.full-name')?.textContent.trim() || '';
                const pairsCell = row.querySelectorAll('td')[index];

                if (!pairsCell) return ''; // –ü–µ—Ä–µ–∫–æ–Ω—É—î–º–æ—Å—è, —â–æ –∫–æ–º—ñ—Ä–∫–∞ —ñ—Å–Ω—É—î

                // –û—Ç—Ä–∏–º—É—î–º–æ –≤–º—ñ—Å—Ç —Ç–∞ –ø—Ä–∏–±–∏—Ä–∞—î–º–æ –∑–∞–π–≤—ñ –ø—Ä–æ–±—ñ–ª–∏
                const details = pairsCell.textContent.trim();

                // –Ø–∫—â–æ –≤ –ø–∞—Ä—ñ –Ω–µ–º–∞—î –∫–æ–Ω—Ç–µ–Ω—Ç—É (–ø–æ—Ä–æ–∂–Ω—å–æ –∞–±–æ —Ç—ñ–ª—å–∫–∏ –ø—Ä–æ–±—ñ–ª–∏) ‚Äî –Ω–µ –¥–æ–¥–∞—î–º–æ
                return details && details !== "" ? `
                            <div class="schedule-card">
                                <h3>${day} ‚Äì –ü–∞—Ä–∞ ${periodNumber} (${timeRange})</h3>
                                <p>${pairsCell.innerHTML.trim()}</p>
                            </div>
                        ` : '';
              })
              .join('');

            if (daySchedule.trim() !== '') {
              scheduleHTML += `<h3>${day}</h3>` + daySchedule;
            }
          });
          scheduleContainer.innerHTML = scheduleHTML;
          localStorage.setItem(scheduleCacheKey, scheduleHTML);

        } else if (isAllDaysLogin) {
          loadSchedulelogin();
        } else {
          // –Ø–∫—â–æ –≤–∏–±—Ä–∞–Ω–æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–∏–π –¥–µ–Ω—å, –ø—Ä–∞—Ü—é—î–º–æ —è–∫ —Ä–∞–Ω—ñ—à–µ
          const scheduleItems = Array.from(table.querySelectorAll('tbody tr'))
            .map(row => {
              const hourTh = row.querySelector('th.hour-name');
              if (!hourTh) return '';

              const periodNumber = hourTh.querySelector('.name')?.textContent.trim() || '';
              const timeRange = hourTh.querySelector('.full-name')?.textContent.trim() || '';
              const pairsCell = row.querySelectorAll('td')[selectedDayIndex];

              if (!pairsCell) return '';

              // –ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ —á–∏ —î –≤ –ø–∞—Ä—ñ –∫–æ–Ω—Ç–µ–Ω—Ç
              const details = pairsCell.textContent.trim();

              if (!details) return '';

              return `
                        <div class="schedule-card">
                            <h3>${days[selectedDayIndex]} ‚Äì –ü–∞—Ä–∞ ${periodNumber} (${timeRange})</h3>
                            <p>${pairsCell.innerHTML.trim()}</p>
                        </div>
                    `;
            })
            .filter(item => item !== '')
            .join('');

          const scheduleWithHeader = `<h2>–†–æ–∑–∫–ª–∞–¥ –¥–ª—è ${selectedGroupName} (${days[selectedDayIndex]})</h2>`;

          scheduleContainer.innerHTML = scheduleItems
            ? scheduleWithHeader + scheduleItems
            : showError("–ù–µ–º–∞—î –ø–∞—Ä –Ω–∞ —Ü–µ–π –¥–µ–Ω—å");

          localStorage.setItem(scheduleCacheKey,
            scheduleItems
              ? scheduleWithHeader + scheduleItems
              : showError("–ù–µ–º–∞—î –ø–∞—Ä –Ω–∞ —Ü–µ–π –¥–µ–Ω—å")
          );
        }

      } catch (err) {
        console.error("‚ùå –ü–æ–º–∏–ª–∫–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ä–æ–∑–∫–ª–∞–¥—É:", err);
        scheduleContainer.innerHTML = showError("–ü–æ–º–∏–ª–∫–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ä–æ–∑–∫–ª–∞–¥—É");
      }
      updateCardEffects();
    }

    // –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è
    populateDayMenu();
    loadGroups();

    document.addEventListener("click", (event) => {
      const selectedGroup = event.target.closest(".group-item");
      if (!selectedGroup) return;

      document.querySelectorAll(".group-item").forEach(item => item.classList.remove("active"));
      selectedGroup.classList.add("active");

      const selectedGroupUrl = selectedGroup.dataset.href;
      localStorage.setItem("selectedGroup", selectedGroupUrl); // ‚úÖ –ó–ë–ï–†–Ü–ì–ê–Ñ–ú–û –≥—Ä—É–ø—É
      console.log("üîÑ –ó–∞–≤–∞–Ω—Ç–∞–∂—É—î–º–æ —Ä–æ–∑–∫–ª–∞–¥ –¥–ª—è –≥—Ä—É–ø–∏:", selectedGroupUrl);

      // –ó–∞–≤–∞–Ω—Ç–∞–∂—É—î–º–æ —Ä–æ–∑–∫–ª–∞–¥ –¥–ª—è –≤–∏–±—Ä–∞–Ω–æ—ó –≥—Ä—É–ø–∏
      loadSchedule(selectedGroupUrl);
    });



    // showLoader();

  </script>
</body>

</html>